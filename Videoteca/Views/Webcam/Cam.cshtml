@{
    ViewBag.Title = "Webcam";
    Layout = null;
}

<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>VideoTeca SharePlay</title>
    <style>
        body {
            background-color: beige;
        }

        #videoContainer {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 80vh;
        }

        #videoElement {
            width: 100%;
            max-width: 800px;
            transform: scaleX(-1);
        }
    </style>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1 style="text-align: center;">VideoTeca SharePlay</h1>
    <div id="videoContainer">
        <video id="videoElement" autoplay></video>
    </div>
    <button id="startButton">Iniciar Captura</button>
    <button id="stopButton">Detener Captura</button>

    <script>
        var videoElement = document.getElementById("videoElement");
        var startButton = document.getElementById("startButton");
        var stopButton = document.getElementById("stopButton");
        var isCapturing = false;
        var stream;

        startButton.addEventListener("click", function () {
            if (!isCapturing) {
                startCapture();
                isCapturing = true;
                startButton.disabled = true;
                stopButton.disabled = false;
            }
        });

        stopButton.addEventListener("click", function () {
            if (isCapturing) {
                stopCapture();
                isCapturing = false;
                startButton.disabled = false;
                stopButton.disabled = true;
            }
        });

        function startCapture() {
            navigator.mediaDevices.getUserMedia({ video: true })
                .then(function (mediaStream) {
                    stream = mediaStream;
                    videoElement.srcObject = mediaStream;
                })
                .catch(function (error) {
                    console.log("Error al acceder a la cámara: " + error);
                });
        }

        function stopCapture() {
            if (stream) {
                stream.getTracks().forEach(function (track) {
                    track.stop();
                });
                videoElement.srcObject = null;
            }
        }
    </script>
</body>
</html>
